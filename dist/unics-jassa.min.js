var unicsjassa=angular.module("UnicsJassa",[]).provider("configuration",function(){var e;this.initialize=function(r){e=r},this.$get=function(){return e}});$.get("/config/unics-config.json",function(t){unicsjassa.config(function(r,e,n){r.initialize(t)}).run(function(){window.jassa=new Jassa(Promise,$.ajax),window.sparql=jassa.sparql,window.rdf=jassa.rdf})}),angular.module("UnicsJassa").service("AggregateFunctions",function(){var r=jassa.sparql,e=_.map([r.AggAvg,r.AggCount,r.AggMax,r.AggMin,r.AggSum],function(r){return(new r).name});return _.zipObject(_.map(e,function(r){return r.toUpperCase()}),e)}),angular.module("UnicsJassa").factory("Prefixes",function(r,e){var n=new rdf.PrefixMappingImpl(e.prefixes);return{getPrefixOntop:function(){return"ontop"},getPrefixRdf:function(){return"rdf"},getPrefixDcterms:function(){return"dcterms"},getPrefixRis3cat:function(){return"ris3cat"},prefixMapping:n,getUriPrefix:function(r){return n.getNsPrefixURI(r)}}}),angular.module("UnicsJassa").service("SparqlFacade",function(r,i,t){r.prefixMapping;return{typeOf:a,triple:n,instanceOf:function(r,e,n){return new rdf.Triple(i.asVar(r),e,n)},predicateObjectList:s,constraint:function(r,e,n){return new rdf.Triple(r,e,new rdf.NodeFactory.createPlainLiteral(n,null))},generateAggregators:function(r){var e,n=new sparql.VarExprList;return r.forEach(function(r){switch(r.aggregationType){case t.AVG:e=sparql.AggregatorFactory.createAvg(r.isDistinct,r.getVar());break;case t.COUNT:e=sparql.AggregatorFactory.createCount(r.isDistinct,r.getVar());break;case t.MAX:e=sparql.AggregatorFactory.createMax(r.isDistinct,r.getVar());break;case t.MIN:e=sparql.AggregatorFactory.createMin(r.isDistinct,r.getVar());break;case t.SUM:e=sparql.AggregatorFactory.createSum(r.isDistinct,r.getVar())}n.add(r.getAggVar(),new sparql.ExprAggregator(null,e))}),n},exploreObjectType:function(r,e,n){var t=new sparql.ElementTriplesBlock;return t.addTriples(a(r,e)),t.addTriples(s(r,n).getTriples()),t},setAsOptional:function(r){return new sparql.ElementOptional(r)},setFilter:function(e,r,n,t){var a=_([].concat(r)).map(function(r){return new sparql[n](new sparql.ExprVar(i.asVar(e)),_.isInteger(r)?sparql.NodeValueUtils.makeInteger(r):sparql.NodeValueUtils.makeString(r))}).value();return new sparql.ElementFilter(1==a.length?_.first(a):"OR"==t?sparql.ExprUtils.orify(a):sparql.ExprUtils.andify(a))},setFilterByNodeUri:function(e,r,n,t){var a=_([].concat(r)).map(function(r){return new sparql[n](new sparql.ExprVar(i.asVar(e)),r)}).value();return new sparql.ElementFilter(1==a.length?_.first(a):"OR"==t?sparql.ExprUtils.orify(a):sparql.ExprUtils.andify(a))},getReferencedVarsInFilters:function(r){var e=new sparql.VarExprList;return e.addAll(_(r).map(function(r){return r.getVarsMentioned()}).flatten().value()),e},getVarsAndValuesFromFilter:function(r){var t=[],a=function(r){return r instanceof sparql.E_LogicalAnd||r instanceof sparql.E_LogicalOr};jassa.util.TreeUtils.visitDepthFirst(r.expr,function(r){return _.filter([r.left,r.right],function(r){return a(r)})},function(r){var e=!1,n=[];a(r)?(n=_.filter([r.left,r.right],function(r){return!a(r)}),e=!(2==n.length)):n.push(r);return t=t.concat(n),e});var e={};return t.forEach(function(r){null==e[r.getLeft().asVar().name]&&(e[r.getLeft().asVar().name]=[]),e[r.getLeft().asVar().name].push({value:r.getRight().node.getLiteral().val,op:r.name})}),e},negateFilter:function(r){return new sparql.ElementFilter(new sparql.E_LogicalNot(r.expr))},constraintBoolean:function(r,e,n){return new rdf.Triple(r,e,sparql.NodeValueUtils.createLiteral(n,jassa.vocab.xsd.xboolean.getUri()))},findElementFiltersByVars:function(r,n){return _.find(r,function(r){var e=new sparql.VarExprList;return e.addAll(r.getVarsMentioned()),_.some(n,function(r){return e.contains(r)})})}};function a(r,e){return new rdf.Triple(i.asVar(r),jassa.vocab.rdf.type,e)}function n(r,e,n){return new rdf.Triple(i.asVar(r),e,i.asVar(n))}function s(e,r){return new sparql.ElementTriplesBlock(_(r).map(function(r){return r instanceof Object&&r.constructor===Object?n(e,r.p,r.o):n(e,r,r)}).value())}}),angular.module("UnicsJassa").service("unics",["Prefixes","configuration",function(a,r){var i={asVar:e,asVars:function(r){return _(r).map(function(r){return e(r)}).value()},asString:function(r){return rdf.NodeUtils.toPrettyString(r)}};function e(r){return rdf.NodeFactory.createVar(rdf.NodeUtils.toPrettyString(r))}return _.forOwn(r.taxonomies,function(r,e){var n,t;i=_.merge(i,(n=r,t=a.getUriPrefix(e),_.zipObject(_.map(n,function(r){return _.replace(r,new RegExp("-","g"),"_")}),_.map(n,function(r){return rdf.NodeFactory.createUri(t+r.toString())}))))}),i}]);